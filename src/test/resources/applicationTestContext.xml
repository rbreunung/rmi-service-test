<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans.xsd">

  <import resource="applicationContext.xml"/>

  <!-- Service Implementation Bean imported from parent definition ->
  <bean id="calculatorService"
        class="de.antrophos.test.rmi.service.calculator.CalculatorServiceImpl"/> -->

  <!-- RMI Registry on static port 1211 -->
  <bean id="rmiRegistry"
        class="org.springframework.remoting.rmi.RmiRegistryFactoryBean">
    <property name="port" value="1211"/>
  </bean>

  <!-- RMI Service Exporter for registry-based lookup on port 1211 -->
  <bean id="calculatorServiceExporter"
        class="org.springframework.remoting.rmi.RmiServiceExporter">
    <property name="service" ref="calculatorService"/>
    <property name="serviceInterface" value="de.antrophos.test.rmi.service.CalculatorService"/>
    <property name="serviceName" value="CalculatorService"/>
    <property name="registryPort" value="1211"/>
  </bean>

  <!-- Direct RMI Service Exporter on static port 12172 (with integrated registry / without separate registry)

        This configuration is a common practice, especially when you need to configure RMI to work behind a
        firewall that only allows traffic on a specific port. By fixing the servicePort to the same value as
        the registryPort, you avoid the RMI service binding to an anonymous, randomly assigned port, which
        would likely be blocked by a firewall.
   -->
  <bean id="calculatorServiceDirectExporter"
        class="org.springframework.remoting.rmi.RmiServiceExporter">
    <property name="service" ref="calculatorService"/>
    <property name="serviceInterface" value="de.antrophos.test.rmi.service.CalculatorService"/>
    <property name="serviceName" value="CalculatorService"/>
    <property name="registryPort" value="12172"/>
    <property name="servicePort" value="12172"/>
  </bean>
</beans>